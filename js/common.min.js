function toggleFullScreen(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}function fetch(a,b){var c=$.cookie(a),d=window.localStorage.getItem(a);return chrome&&chrome.storage?(chrome.storage.local.get(a,function(a){b=a.name}),void 0):c||d?c||d:null}function store(a,b){$.cookie(a,b,{expires:365}),window.localStorage.setItem(a,b),chrome&&chrome.storage&&chrome.storage.local.set({name:b})}function achievement(){msg_icon.removeClass().addClass("icon-trophy"),msg.fadeIn(),setTimeout(function(){msg.fadeOut()},1500)}function goDash(){var a=ROUNDS_TO_HIDE;a+=~~(20*Math.random()),game.prepare(challenges,konami?konami_lives:3,BEST_SCORE,a),tic=(new Date).getTime(),game.start()}var W,H,SITE=escape("http://dash.breno.io/"),listener=new window.keypress.Listener,msg=null,msg_icon=null,game=null,end_game_view=null,last_score=null,last_time=null,konami=!1,best=0,BEST_SCORE=0,tic=0,shares={fb:null,tw:null},times={press_time:1500,step:5},konami_lives=42,ROUNDS_TO_HIDE=120,tutorial=1,message=null,tutorial_btn={on:null,off:null},taught=[],challenges=[{alias:"simple",morph:function(a){return{expected:[a.expected[0]]}},text:"Press the key/swipe to the direction of the arrow"},{alias:"reverse",constraints:["pressed","previous"],rounds:30,morph:function(a){for(var c=a.expected.length,d={expected:[]},e=0;c>e;e++)d.expected.push(mod(a.expected[e]+2,4));return d},text:"Press the key/swipe to the opposite direction of the arrow"},{alias:"double",constraints:["pressed","previous"],rounds:20,morph:function(a){return{expected:[a.expected[0],a.expected[0]]}},text:"Press the key/swipe twice to the direction of the arrow"},{alias:"previous",first_turn:!1,constraints:["reverse","double","pressed"],rounds:50,morph:function(a,b){return{expected:b.expected,missable:b.missable}},text:"Repeat your previous action"},{alias:"pressed",constraints:["reverse","double","pressed"],rounds:40,morph:function(){return{expected:[],missable:!1}},text:"Do not do anything!"}];listener.sequence_combo("up up down down left right left right b a enter",function(){konami^=!0,msg_icon.removeClass().addClass("icon-joystick"),msg.fadeIn(),setTimeout(function(){msg.fadeOut()},1500)}),$(document).ready(function(){$("#btn_howto").click(function(){$("#info").fadeIn("slow",function(){$(this).css("overflow","auto")})}),$(".dismiss").click(function(){$(this).parent().fadeOut("slow")}),W=$(window).width(),H=$(window).height(),msg=$("#msg"),msg_icon=$("#msg_icon"),end_game_view=$("#end_game_view"),best=$("#best"),last_score=$("#last_score"),last_time=$("#last_time"),shares.fb=$("#fb_share_score"),shares.tw=$("#tw_share_score"),$("#btn_leader").click(function(){fb_update_leaderboard(),$("#no_leaderboard").hide(),$("#loading").show(),$("#leaderboards").fadeIn("slow",function(){$(this).css("overflow","auto")})}),message=$("#tutorial"),tutorial_btn={on:$("#tutorial_on"),off:$("#tutorial_off")},$("#btn_full").click(toggleFullScreen),$(".gp").click(function(){var a=~~((W-600)/2),b=~~((H-600)/2);window.open("https://plus.google.com/share?url="+SITE,"Dash","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600,left="+a+",top="+b)}),null===fetch("tutorial")&&store("tutorial",challenges.length),tutorial=parseInt(fetch("tutorial")),0!==tutorial&&(tutorial_btn.on.toggle(),tutorial_btn.off.toggle()),tutorial_btn.on.click(function(){tutorial=challenges.length,$.cookie("tutorial",challenges.length,{expires:365}),window.localStorage.setItem("tutorial",challenges.length),tutorial_btn.on.toggle(),tutorial_btn.off.toggle()}),tutorial_btn.off.click(function(){tutorial=0,$.cookie("tutorial",0,{expires:365}),window.localStorage.setItem("tutorial",0),tutorial_btn.on.toggle(),tutorial_btn.off.toggle()}),$("#fb_share").click(function(){FB.ui({name:"Dash",method:"share",href:"http://dash.breno.io/",caption:"How fast can you dash?",app_id:"903632352992329"},function(){})}),Interface=new DashGUI({panels:["#panel-0","#panel-1"],icons:["#panel-0 i","#panel-1 i"],score:{main:"#score",timer:"#gauge",lives:".lives div",points:"#counter"}},{base_index:1e3,presets:8,panel:"preset-*",icon:"icon-angle-.",wrong_icon:"icon-cancel",life_lost:"+lost",correct_icon:"+correct",replace_array:["left","up","right","down"]},{1:{panel:"reverse-*"},2:{icon:"icon-angle-double-."},3:{icon:"icon-cw"},4:{icon:"+pressed"}});var a={on_panel_retrieve:function(a,b,c){var d=b[0];0===tutorial||taught.has(d)||(game.pause(),message.html(challenges[d].text),message.fadeIn("fast"),0===c.length&&setTimeout(function(){message.fadeOut("fast"),game.resume(),game.correct()},2e3),taught.push(d)===challenges.length&&($.cookie("tutorial","0",{expires:365}),window.localStorage.setItem("tutorial",0),tutorial_btn.on.toggle(),tutorial_btn.off.toggle()))},after_game:function(a){var b=(new Date).getTime(),c=~~((b-tic)/1e3);last_time.html(c),last_score.html(a);var d="I've made "+a+" points in Dash! Can you dash faster? #Dash";d=escape(d),_gaq.push(["_setCustomVar",1,"Section","Score",a]),_gaq.push(["_setCustomVar",2,"Section","Time",c]),end_game_view.fadeIn("slow",function(){$(this).css("overflow","auto")}),a>BEST_SCORE&&($.cookie("best",a,{expires:365}),window.localStorage.setItem("best",a),BEST_SCORE=a,best.html(BEST_SCORE),window.fb_update_score(a),shares.fb.click(function(){FB.api("/me/feed","post",{message:d},function(a){!a||a.error?console.log("Error occured"):console.log("Post ID: "+a.id)})}))},best_score:function(){achievement()},lost_life:function(){},got_point:function(){},key_pressed:function(a){0!==tutorial&&game.is_paused()&&game.test(a)&&(tutorial--,game.resume(),message.fadeOut("fast"),game.correct())}};game=new Dash(Interface,a,times).init(),$("#btn_play").click(function(){goDash()}),$("#btn_again").click(function(){goDash(),end_game_view.fadeOut()})});